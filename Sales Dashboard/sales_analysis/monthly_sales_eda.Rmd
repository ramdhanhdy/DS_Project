---
title: "R Notebook"
output: html_notebook
---


```{r}
library(ggplot2)
library(dplyr)
library(ggstatsplot)
library(lubridate)
library(readr)
```
```{r}
glimpse(monthly_sales)
```
## Analyzing Overall Correlation between Variables

```{r}
correlation_numerical <- cor(monthly_sales[c("TotalRevenue", "TotalBudget", "TotalQuantity")])
print(correlation_numerical)
```

The result shows a moderate positive correlation (approximately 0.56) between the budget allocated for sales efforts and the total revenue generated. This suggests that increasing the sales budget has the potential to positively influence revenue. However, the correlation is not as strong as the relationship between total quantity sold and total revenue. 

So, while total quantity sold has a clear and more significant impact on revenue, increasing the sales budget strategically can still contribute to revenue growth. Companies should carefully plan and allocate resources to sales initiatives to maximize their revenue-generating potential.

```{r}
#TotalRevenue anova 
revenue_anova <- aov(TotalRevenue ~ Month + Salesperson + Supervisor + Manager, data = monthly_sales)
# Print the ANOVA result
print(summary(revenue_anova))
```

Interpretation:

- **Month**: The p-value (Pr(>F)) is 6.89e-06 (less than 0.05), which means that the 'Month' variable has a significant effect on TotalRevenue.

- **Salesperson**: The p-value (Pr(>F)) is less than 2e-16 (extremely small), showing that the 'Salesperson' variable has a highly significant effect on TotalRevenue.

- Other variables are not shown and summarized as Residuals due to the lack of variation it gives on Total Revenue

## Analyzing budget impacts on revenue

```{r}
# Calculate the correlation between TotalBudget and TotalRevenue for each month
correlation_by_month <- monthly_sales %>%
  group_by(Month) %>%
  summarize(correlation = cor(TotalBudget, TotalRevenue))

correlation_table <- correlation_by_month %>%
  mutate(Month = factor(Month, levels = c('Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec')))

correlation_by_month
```

```{r}
#bar plot to visualize the correlation by month
ggplot(correlation_table, aes(x = Month, y = correlation)) +
  geom_bar(stat = "identity") +
  labs(title = "Correlation between TotalBudget and TotalRevenue by Month",
       x = "Month",
       y = "Correlation")
```

The correlation results highlight the varying impact of the budget (TotalBudget) on revenue (TotalRevenue) across different months, with some months exhibiting stronger relationships than others:

- High Positive Impact in December (correlation = 0.828): December stands out as the month when the budget has the most
substantial positive impact on revenue. This observation aligns with the holiday season, where consumer spending tends to increase due to festivities and gift-giving. Businesses can leverage this insight by allocating more resources to marketing and promotions during December to capitalize on the higher revenue potential.

- Strong Effects in January and May: January (correlation = 0.697) and May (correlation = 0.773) also show notable correlations between the budget and revenue. In January, businesses can take advantage of New Year's resolutions and promotions to attract customers seeking fresh starts. For May, businesses might focus on seasonal sales or promotions to tap into increased consumer activity during springtime.

- Moderately Positive Impacts: August (correlation = 0.662), July (correlation = 0.617), and June (correlation = 0.640) exhibit moderate positive correlations. These summer months may present opportunities for businesses to invest in targeted marketing campaigns, taking advantage of vacations and leisure activities when consumer spending tends to rise.

- Moderate to Low Impacts in February, November, April, and March: These months show relatively lower correlations, suggesting that the budget's influence on revenue is not as pronounced during these periods. Businesses may adopt a cautious approach in allocating resources during these months, focusing on optimizing existing operations rather than aggressive budget expansions.


```{r}
# Create a data frame to store the time lag correlation results
lag_correlation_results <- data.frame(Month = character(),
                                      Correlation = numeric(),
                                      stringsAsFactors = FALSE)

# Calculate the time lag correlation for each month
for (i in unique(monthly_sales$Month)) {
  # Filter data for the current month
  current_month_data <- monthly_sales %>%
    filter(Month == i)
  
  # Create a lagged version of the 'TotalBudget' variable with a one-month lag
  current_month_data <- current_month_data %>%
    mutate(LaggedBudget = lag(TotalBudget, 2))
  
  # Calculate the correlation between the lagged budget and 'TotalRevenue'
  time_lag_correlation <- cor(current_month_data$TotalRevenue, current_month_data$LaggedBudget, use = "complete.obs")
  
  # Add the result to the lag_correlation_results data frame
  lag_correlation_results <- rbind(lag_correlation_results, data.frame(Month = i, Correlation = time_lag_correlation))
}

# Sort the results by correlation in descending order
lag_correlation_results <- lag_correlation_results %>%
  arrange(desc(Correlation))

# Print the result
print(lag_correlation_results)
```

## determine if lagging effect is statistically significant


```{r}
# Assuming the dataset is named 'monthly_sales'
# Create a lagged version of the 'TotalBudget' variable with a two-month lag
monthly_sales_lagged <- monthly_sales %>%
  mutate(LaggedBudget = lag(TotalBudget, 1))

# Perform the significance test for the correlation
correlation_test <- cor.test(monthly_sales_lagged$TotalRevenue, monthly_sales_lagged$LaggedBudget)

# Print the result
print(correlation_test)
```
There is no significant linear relationship between the budget and revenue with a one-month lag. The correlation coefficient of approximately -0.006 suggests an extremely weak association, and the p-value of 0.9252 indicates that this correlation is not statistically significant. Other factors may have a more substantial impact on short-term revenue variations.

```{r}
# Assuming the dataset is named 'monthly_sales'
# Create a lagged version of the 'TotalBudget' variable with a two-month lag
monthly_sales_lagged <- monthly_sales %>%
  mutate(LaggedBudget = lag(TotalBudget, 2))

# Perform the significance test for the correlation
correlation_test <- cor.test(monthly_sales_lagged$TotalRevenue, monthly_sales_lagged$LaggedBudget)

# Print the result
print(correlation_test)
```

The correlation coefficient (0.029) is close to zero, indicating a very weak linear relationship between the lagged budget and revenue. Additionally, the p-value of 0.6565 is substantially higher than the common significance level of 0.05. This high p-value suggests that the observed correlation is not statistically significant, meaning there is insufficient evidence to reject the null hypothesis that the true correlation is equal to zero.

Practical Implications:
Based on these findings, businesses should prioritize monitoring and adjusting their budgets with a focus on the short term. Budget allocation decisions should consider immediate revenue impact, as any potential influence on revenue variations from budget adjustments diminishes quickly over time. It is essential to analyze additional factors and potential non-linear relationships that might play a more significant role in driving revenue fluctuations.
